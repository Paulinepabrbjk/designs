const jscad = require('@jscad/modeling')
const { polyhedron } = jscad.primitives
const { colorize, hexToRgb } = jscad.colors

const volume = () => {

  const faces =[[5,10,8],[10,13,89],[10,89,8],[12,13,10],[12,54,13],[13,16,101],[40,10,5],[40,12,10],[45,12,40],[45,49,12],[49,54,12],[54,16,13],[89,13,101],[0,2,1],[0,3,2],[2,5,1],[2,6,5],[3,6,2],[18,23,21],[22,23,18],[22,25,23],[23,24,21],[23,25,24],[40,39,45],[44,48,43],[45,42,49],[46,44,43],[46,47,44],[47,48,44],[47,50,48],[49,55,54],[50,47,46],[101,99,89],[86,97,96],[87,97,86],[87,99,97],[97,102,96],[99,102,97],[27,31,28],[27,37,31],[29,37,27],[31,37,36],[34,37,29],[56,61,57],[56,66,61],[59,64,56],[61,66,65],[64,66,56],[69,71,68],[69,77,71],[71,85,78],[77,85,71],[107,116,115],[116,118,115],[86,92,81],[102,110,92],[0,7,3],[1,4,0],[1,8,4],[3,9,6],[4,7,0],[4,79,7],[5,8,1],[6,33,5],[6,35,33],[7,9,3],[7,88,9],[8,79,4],[8,89,79],[9,11,35],[9,35,6],[9,88,11],[11,43,35],[11,46,43],[11,98,46],[14,15,50],[15,18,58],[15,22,18],[16,20,101],[16,21,20],[17,22,15],[17,25,22],[18,21,16],[19,24,17],[20,24,19],[21,24,20],[24,25,17],[26,29,27],[26,30,29],[27,28,26],[28,30,26],[28,32,30],[28,36,32],[29,38,34],[30,38,29],[31,36,28],[32,33,30],[33,32,40],[33,38,30],[33,40,5],[34,41,37],[34,42,41],[35,38,33],[36,39,32],[36,41,39],[37,41,36],[38,42,34],[38,48,42],[39,40,32],[41,45,39],[42,45,41],[42,51,49],[43,38,35],[43,48,38],[46,14,50],[48,51,42],[48,53,51],[48,58,53],[50,15,58],[51,52,49],[51,59,52],[52,55,49],[52,57,55],[52,59,56],[53,59,51],[53,64,59],[54,60,16],[54,62,60],[55,62,54],[56,57,52],[57,62,55],[57,65,62],[58,18,60],[58,48,50],[60,18,16],[60,53,58],[60,63,53],[61,65,57],[62,63,60],[62,67,63],[63,64,53],[63,67,64],[64,67,66],[65,67,62],[66,67,65],[68,71,70],[68,72,69],[68,73,72],[70,73,68],[70,76,73],[70,84,76],[71,78,70],[72,77,69],[73,74,72],[73,80,74],[73,82,80],[73,90,82],[74,75,72],[74,80,79],[74,83,75],[75,77,72],[75,81,77],[75,86,81],[76,90,73],[76,91,90],[78,84,70],[78,85,84],[79,80,88],[79,83,74],[79,88,7],[80,94,88],[80,95,94],[81,85,77],[81,92,85],[82,95,80],[83,86,75],[83,87,86],[83,89,87],[84,91,76],[84,93,91],[85,93,84],[85,100,93],[86,96,92],[88,94,98],[88,98,11],[89,83,79],[89,99,87],[90,95,82],[90,105,95],[91,105,90],[91,109,105],[92,100,85],[92,110,100],[93,109,91],[94,103,98],[94,104,103],[95,104,94],[95,105,104],[96,102,92],[98,14,46],[98,15,14],[98,103,108],[99,106,102],[100,109,93],[100,110,107],[101,20,106],[102,112,110],[102,114,112],[103,111,108],[103,113,111],[104,113,103],[105,113,104],[106,19,108],[106,20,19],[106,99,101],[106,114,102],[107,109,100],[107,115,109],[108,15,98],[108,17,15],[108,19,17],[108,114,106],[109,113,105],[109,119,113],[110,116,107],[111,114,108],[111,116,114],[112,116,110],[113,116,111],[113,119,116],[114,116,112],[115,117,109],[115,118,117],[116,119,118],[117,119,109],[118,119,117]]
  const vertices = [[-179.50426302,57.11244596,-161.98191043],[-171.96333132,0.44579519,-115.51164027],[-164.53991136,9.34736026,-204.25028201],[-146.66819773,71.2706281,-187.17615481],[-139.28684435,35.83702339,-15.95286723],[-110.93161783,-19.03605448,-105.01967784],[-110.7521554,25.31871242,-164.44997188],[-109.46604929,79.31232465,-8.74453898],[-104.69148836,-14.33445918,-13.10670253],[-102.64123163,68.93368019,-104.31353923],[-63.5701581,-49.92125975,-47.65563365],[-59.95924196,101.14297403,-97.46514674],[0.7567195,-79.99404418,-102.69797679],[30.95069447,-55.28692709,-8.85396357],[61.60213747,100.95851434,-97.03801509],[99.89224234,72.05704225,-94.77544185],[106.27716818,-19.24215304,-71.22243281],[112.22036162,82.81077398,-26.72870036],[112.26546087,25.30601723,-164.44660541],[118.23154249,36.91917611,24.30702809],[132.28650847,-10.4106568,-36.93576213],[147.29149618,-16.89505087,-143.83199092],[149.01381293,71.12350477,-188.15506335],[168.49403181,12.76714934,-204.62281581],[174.335287,35.30671252,-98.99634715],[177.45509901,61.59465326,-154.91773005],[-185.47838411,-127.73569571,-207.01571818],[-181.91501818,-160.88222014,-143.59887477],[-168.95715914,-126.84062468,-110.85547801],[-156.54118738,-169.82106673,-249.29892417],[-147.34652719,-94.90383612,-198.01720973],[-120.53060732,-179.75770461,-84.00859233],[-117.47044763,-108.47625243,-151.89486857],[-106.51203356,7.9959513,-191.34372111],[-100.74613771,-188.60190855,-251.87043305],[-93.97153101,65.0898291,-196.20810862],[-81.86108789,-154.18622481,-91.18871089],[-72.71553716,-200.61847197,-154.93739482],[-71.27061567,34.68829049,-250.83853599],[-69.66500006,-127.72342192,-162.70128604],[-64.80934343,-60.065894,-156.71822902],[-56.88776693,-169.93472563,-212.56778594],[-44.07191953,-40.68001734,-251.34704467],[-41.71879015,92.81965745,-225.55840846],[-41.70358381,126.86450494,-243.3217084],[-30.13305864,-68.91790854,-197.10465785],[1.14674152,113.69148744,-161.10985156],[23.07775059,151.39986528,-224.97138854],[24.22174015,78.20796503,-251.55211802],[30.66796341,-72.00324522,-197.42912646],[43.96020212,98.89660371,-202.52071734],[45.63070097,-30.5687617,-251.56471129],[58.39935579,-169.9329518,-212.56885405],[62.03954973,40.06390942,-251.4725339],[65.14852324,-68.23821532,-152.42591258],[71.17843905,-127.72342192,-162.70128604],[74.22897616,-200.61847197,-154.93739482],[83.37452688,-154.18622481,-91.18871089],[95.48497,65.0898291,-196.20810862],[102.26053038,-188.60152709,-251.87225457],[108.38650503,15.6667806,-199.63685389],[122.04404631,-179.75770461,-84.00859233],[133.4476737,-100.62743651,-157.92666789],[146.26671591,-93.53887068,-226.95812579],[158.1460742,-169.79484068,-249.00241729],[170.47059813,-126.84062468,-110.85547801],[183.42845717,-160.88222014,-143.59887477],[186.9918231,-127.73569571,-207.01571818],[-196.03843889,20.26814235,248.67565755],[-156.93630419,-8.06892144,221.78291921],[-155.60364923,36.96039928,314.07093648],[-140.60084543,-0.7096337,291.23711232],[-136.22719011,18.05575264,168.06900624],[-133.40327463,55.28005851,187.88105611],[-123.06270799,-3.02845704,91.80016164],[-117.35715113,-41.66117178,162.47601155],[-116.72006807,45.29821409,238.92048482],[-114.15156565,10.27542366,234.24427632],[-102.59997568,15.72415365,328.67249135],[-83.69514665,26.58514811,58.68507985],[-83.18941316,107.07793249,90.9563506],[-78.0199214,-58.19404112,238.03906087],[-67.43552885,125.03744615,162.47601155],[-66.66098318,-70.60009467,77.52003316],[-66.0477992,41.6774,285.11643056],[-64.76773462,-13.35730063,282.3866332],[-60.33023557,-93.35608946,136.59264211],[-55.90763292,-103.31878172,76.11729268],[-47.99402437,78.42794431,46.01158742],[-39.47928152,-10.61829554,37.64362935],[-35.96921644,122.17606081,234.50028066],[-5.62294981,79.85721601,290.60539846],[0.7567195,-86.32829176,233.65589742],[0.7567195,19.35457719,304.83578328],[0.7567195,134.26382555,91.29227285],[0.7567195,141.38607515,162.47601155],[2.9683789,-104.37874304,148.69995717],[6.89789632,-142.42490279,122.6076949],[11.17458263,98.67031587,48.87386922],[20.54992356,-112.39758955,58.44669942],[28.51671257,-33.16056239,289.87000112],[29.98649397,-18.57106196,33.56003408],[57.25026884,-95.40383803,127.49634389],[62.40021982,118.86845125,91.29227285],[68.94896784,125.03744615,162.47601155],[71.47995272,104.92264761,233.62366323],[71.50212565,-1.4263414,50.67024831],[73.84820738,-2.34679924,274.66702108],[77.98278132,50.74158681,56.77593831],[78.5324029,41.34735478,280.55504445],[79.81782713,-57.86799895,238.5326827],[107.52846518,76.80920137,91.29227285],[118.87059012,-41.66117178,162.47601155],[118.87059012,80.37032617,162.47601155],[121.83269301,-7.70892846,90.46059255],[124.6458415,4.06936182,320.93460683],[137.92696753,17.59829772,182.46887807],[164.1588954,35.99406792,311.10428456],[167.42765227,-10.44022309,230.21584157],[172.64306822,35.68497194,208.150183]]
  const groups = [1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]

	var vs = vertices.map(x=> x.map(y=> y * 1))	
	
	const distinctGroups = [...new Set(groups)]
	var facesG = []

	var r = []
	for(var i = 0; i < distinctGroups.length; i++){
		var tmp = []
		for(var j = 0; j < groups.length; j++) { 
			if(groups[j] == distinctGroups[i]){
				tmp.push(faces[j])
			}
		}
		r.push(polyhedron({points:vs, faces:tmp}))
	}

	return r
}


const getParameterDefinitions = () => {
  return [
     { name: 'c1', type: 'color', initial: '#FFB431', caption: 'Ventre:' }
    ,{ name: 'c2', type: 'color', initial: '#FFB431', caption: 'Pattes avant:' }
    ,{ name: 'c3', type: 'color', initial: '#FFB431', caption: 'Queue:' }
    ,{ name: 'c4', type: 'color', initial: '#FFB431', caption: 'Nez:' }
    ,{ name: 'c5', type: 'color', initial: '#FFB431', caption: 'Pattes arriÃ¨re:' }
    ,{ name: 'c6', type: 'color', initial: '#FFB431', caption: 'Oreilles:' }
    ,{ name: 'c7', type: 'color', initial: '#FFB431', caption: 'Yeux:' }
    ,{ name: 'c8', type: 'color', initial: '#FFB431', caption: 'Corps:' }
  ]
}

const main = (p) => {
  const c = [p.c1,p.c2,p.c3,p.c4,p.c5,p.c6,p.c7,p.c8]
  var r = []

	var obj = volume()
console.log(obj.length)
	for(var i = 0; i< obj.length; i++){
		r.push(colorize(hexToRgb(c[i]), obj[i]))
	}
	return r
}

module.exports = {main, getParameterDefinitions}
